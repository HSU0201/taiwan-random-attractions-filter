<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- 建立jQuary的script -->
    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <!-- bootstrap的link -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <!-- animate的link -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <style>
      :root {
        --attrCard-color-yellow: #e5c046;
        --attrCardInfo-color-yellow: #f5e09d;
        --attrImg-border-gray: rgb(65, 64, 62);
      }
      .header {
        background-image: url(https://live.staticflickr.com/4611/40545139922_01026c8f7f_b.jpg);
        padding-bottom: 2px;
      }

      .left {
        background-color: var(--attrCard-color-yellow);
        border-radius: 10px;
        padding: 5rem 30px 20px 20px;
        align-items: center;
        position: sticky;
        top: 50px;
        height: 800px;
        border-radius: 0% 100% 60% 0% / 100% 27% 73% 0%;
        background: #b0302c;
        background: linear-gradient(to bottom, #b0302c 17%, #cf7f06 100%);
        color: white;
        writing-mode: vertical-rl;
        text-orientation: upright;
        letter-spacing: 0.5rem;
        cursor: pointer;
        p {
          font-size: 2rem;
        }
        .btn {
          font-size: 1.5rem;
          color: #000000;
          background-color: var(--attrCard-color-yellow);
          padding: 10px;
          margin-bottom: 20px;
        }
      }
      .attrCardContainer {
        justify-content: space-around;
        gap: 5px;
        padding: 20px;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;

        /* position: relative; */
        .attrCard {
          position: relative;
          border: 1px solid var(--attrCard-color-yellow);
          width: 15rem;
          border-radius: 10px;
          overflow: hidden;
          margin-block:20px;

          .attrCardImgTop {
            width: 100%;
            height: 10rem;
          }

          .attrCardBody {
            margin-inline: 1rem;
            /* position: relative; */
            overflow: visible;

            .attrCardTitle {
              position: absolute;
              left: 0;
              bottom: 45px;
              -webkit-text-stroke: 0.5px var(--attrCard-color-yellow);
              text-shadow: 1px 1px 0 var(--attrCard-color-yellow);
              color: transparent;
              font-size: 36px;
              font-style: italic;
              font-family: "Montserrat", sans-serif;
              margin: 0;
            }
            .attrCardContent {
              display: flex;
              justify-content: space-between;
              margin: 2rem 1rem 1rem;
              .attrCardText {
                margin: 0;
                padding: 0;
              }
              a {
                color: rgba(255, 0, 0, 0.5);
              }
            }
          }
          .attrCardBody::before {
            /*利用偽元素植入數字與文字*/
            content: attr(data-number); /*載入資料屬性*/
            position: absolute;
            top: 0;
            right: 10px;
            -webkit-text-stroke: 0.5px #f30000;
            text-shadow: 2px 2px 0 var(--attrCard-color-yellow);
            color: white;
            font-size: 26px;
            font-weight: 800;
            z-index: 1;
          }
        }
        .attrBackground {
          background-color: rgb(0, 0, 0);
          width: 100vw;
          height: 100vh;
        }
        .attrInfo {
          background-color: var(--attrCardInfo-color-yellow);
          position: fixed;
          left: 50%;
          top: 50%;
          transform: translate(-50%, -50%);
          padding: 20px;
          width: 85%;
          height: 90%;
          border-radius: 10px;
          overflow: auto;
          z-index: 999;
          display: none;
        }
        .active {
          display: block;
        }
      }
      /* ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ */
      .infoTop {
        display: flex;
        margin: 30px;
      }
      .attrMainInfo {
        margin-left: 2rem;
        flex: 1;
      }

      .attrImg {
        position: relative;
        /* min-width: 15rem; */
        /* max-height: 10rem; */
        img {
          max-width: 100%;
          max-height: 100%;
        }
        span {
          position: absolute;
          bottom: 1rem;
          left: 1rem;
          background-image: linear-gradient(
            rgba(0 0 0 / 0) 40%,
            var(--attrCard-color-yellow) 30%
          );
          font-size: 1.5rem;
          color: rgb(249, 249, 249);
          font-weight: 900;
          text-shadow: 1px 1px rgb(128, 126, 126);
        }
      }
      .attrMainImg {
        margin-bottom: 20px;
        align-items: center;
      }

      .attrImg::before,
      .attrImg::after {
        content: "";
        position: absolute;
        transform: rotate(-35deg);
        width: 70px;
        height: 25px;
        background-color: var(--attrCardInfo-color-yellow);
      }

      .attrImg::before {
        top: -10px;
        left: -25px;
        border-bottom: 1px solid var(--attrImg-border-gray);
      }

      .attrImg::after {
        bottom: -10px;
        right: -25px;
        border-top: 1px solid var(--attrImg-border-gray);
      }
      .attrName {
        font-size: 3rem;
        -webkit-text-stroke: 1px #553700;
        text-shadow: 2px 2px 0 #ffffff;
        color: transparent;
        font-style: italic;
        font-family: "Montserrat", sans-serif;
        margin: 0;
      }
      .attrOpenTime,
      .attrTicketInfo,
      .attrTel,
      .attrAdd {
        font-size: 1.1rem;
        padding: 5px;
        letter-spacing: 2px;
        text-indent: -5.6em;
        transform: translateX(15%);
        span {
          font-size: 1.2rem;
          font-weight: 900;
          background-image: linear-gradient(
            rgba(0 0 0 / 0) 40%,
            var(--attrCard-color-yellow) 30%
          );
        }
      }
      .attrInfoBtn {
        padding-bottom: 2rem;
        margin-bottom: 2rem;
        position: sticky;
        top: 10px;
        z-index: 99;
      }
      .attrRemarks {
        position: relative;
        padding: 1em;
        font-size: 1.2rem;
        border-bottom: 2px solid #52420e;
        background-color: #e5c046;
        border-radius: 20px;
        margin: 20px;
      }
      .attrRemarks span {
        position: relative;
        z-index: 2;
        color: #553700;
        font-weight: 700;
        padding-left: 6em;
      }

      .attrRemarks::before {
        content: attr(data-title);
        position: absolute;
        top: -30px;
        left: -30px;
        color: rgba(73, 66, 42, 0.4);
        font-size: 54px;
        font-weight: 800;
        z-index: 1;
      }
      .attrDescription {
        font-weight: 800;
        margin: 10px;
        font-size: 24px;
      }
      .attrToldescribe {
        /* background: #fffdfd;
        padding: 10px;
        margin: 10px;
        color: rgb(136, 76, 8);
        font-weight: 500; */
        position: relative;
        display: inline-block;
        padding: 10px 20px;
        margin: 20px;
        background: linear-gradient(45deg, #3498db, #6c5ce7);
        color: #ffffff;
        border-radius: 10px;
        font-family: "Arial", sans-serif;
        font-size: 14px;
        margin-right: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .attrToldescribe::before {
        content: "";
        position: absolute;
        top: 50%;
        right: 99%;
        margin-top: -10px;
        border-width: 10px;
        border-style: solid;
        border-color: transparent #3498db transparent transparent;
      }
      .attrTravellinginfo {
        border: 2px solid var(--attrCard-color-yellow);

        padding: 10px;
        margin: 10px;
        span {
          color: rgb(0, 0, 0);
          font-size: 2rem;
          background-image: linear-gradient(
            rgba(0 0 0 / 0) 40%,
            var(--attrCard-color-yellow) 30%
          );
        }
        p {
          color: #000000;
          font-size: 1.5rem;
          margin: 20px;
        }
      }
      /* .del {
        display: none; 
      } */
    </style>

    <style>
      .ctrl {
        position: relative;
        display: flex;
        justify-content: flex-end;
        max-height: 60vh;
        max-width: 1440px;
        margin-bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        overflow: hidden;
        background-color: #ffffff;
        border-radius: 50% 50% 50% 50% / 0% 0% 20% 20%;
        .ctrl_btn {
          position: absolute;
          top: 0;
          width: 15rem;
          height: 100%;
          background-color: transparent;
          border: transparent;
          z-index: 99;
          color: rgb(236, 236, 231);
          font-size: 36px;
        }
        .prev {
          left: 0;
        }
        .next {
          right: 0;
        }
        i {
          display: none;
        }
      }

      .carousel {
        position: relative;
        width: 100%;
        aspect-ratio: 16/9;
        /* 新語法 id或是class不用加 & */

        .image {
          position: absolute;
          width: 100%;
          height: 100%;
          opacity: 0;
          transition: all 0.5s;
          & img {
            width: 100%;
            height: 100%;
            object-fit: cover;
          }
        }
        .active {
          opacity: 1;
        }
      }

      .prev:hover,
      .next:hover {
        background: #000000;
        i {
          display: block;
        }
      }
      .prev:hover {
        background: linear-gradient(to right, #0000007e 20%, #cfcfcf00 100%);
      }
      .next:hover {
        background: linear-gradient(to left, #0000007e 20%, #cfcfcf00 100%);
      }

      .pagination {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 10px;

        .dot {
          width: 1.5rem;
          height: 1.5rem;
          border-radius: 50%;
          background-color: rgb(255, 255, 255);
          cursor: pointer;

          &.active {
            background-color: rgb(66, 146, 130);
          }
        }
      }
    </style>
    <title>homework4</title>
  </head>
  <body>
    <div class="header">
      <div class="ctrl">
        <button id="prev" class="prev ctrl_btn">
          <i class="ctrl_i bi bi-chevron-double-left"></i>
        </button>

        <div class="carousel">
          <div class="image active">
            <img
              src="https://www.kkday.com/zh-my/blog/wp-content/uploads/%E5%8F%B0%E5%8C%97%E6%99%AF%E7%82%B9%E6%8E%A8%E8%8D%90.jpeg"
              alt=""
            />
          </div>
          <div class="image">
            <img
              src="https://i0.wp.com/blog.settour.com.tw/wp-content/uploads/2020/03/%E5%8D%81%E5%A4%A7%E6%97%A5%E7%B3%BB%E6%99%AF%E9%BB%9E.jpg?resize=1024%2C576&ssl=1"
              alt=""
            />
          </div>
          <div class="image">
            <img
              src="https://www.eztravel.com.tw/events/taiwanpromo/image/banner_tb.jpg"
              alt=""
            />
          </div>
          <div class="image">
            <img
              src="https://gsimg.asiayo.com/ay-image-upload/1513049799029_1492573926141_og_taiwan.jpg"
              alt=""
            />
          </div>
          <div class="image">
            <img
              src="https://explorethesun.tw/upload/story_b749350060.jpg"
              alt=""
            />
          </div>
        </div>

        <div class="pagination">
          <div class="dot active animate__animated animate__rubberBand"></div>
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>

        <button id="next" class="next ctrl_btn">
          <i class="ctrl_i bi bi-chevron-double-right"></i>
        </button>
      </div>
    </div>

    <div class="mainContainer d-flex">
      <div class="left col-4 col-sm-2">
        <p>點我查看其他台灣隨機景點</p>
        <!-- <div class="btn">北北基</div>
        <br />
        <div class="btn">宜花東</div>
        <br />
        <div class="btn">桃竹苗</div>
        <br />
        <div class="btn">中彰投</div>
        <br />
        <div class="btn">雲嘉南</div>
        <br />
        <div class="btn">高屏地區</div>
        <br />
        <div class="btn">離島地區</div> -->
      </div>

      <div class="right col-8 col-sm-10">
        <!-- <div class="pagination">
          <button class="prev-page">上一頁</button>
          <button class="next-page">下一頁</button>
        </div> -->
        <div class="attrCardContainer"></div>
      </div>
    </div>

    <div class="footer"></div>
    <script>
      let url = "./scenic_spot_C_f.json";
      $(".attrCardContainer").on("click", ".attrInfoBtn", (e) => {
        $(".attrInfo").removeClass("active");
      });

      $.getJSON(url, function (elem) {
        const randomCard = 100;
        let datas = elem.XML_Head.Infos.Info;
        let filteredArray = datas.filter((item) => {
          return (
            item.Picture1 !== "" &&
            item.Region !== null &&
            item.OpenTime !== "" &&
            item.TicketInfo !== ""
          );
        });

        //==================================================================
        // Fisher-Yates modern shuffle演算法
        // const shuffledArray = [...filteredArray]; // 複製一份原始陣列

        // for (let i = shuffledArray.length - 1; i > 0; i--) {
        //   const j = Math.floor(Math.random() * (i + 1));
        //   [shuffledArray[i], shuffledArray[j]] = [shuffledArray[j],shuffledArray[i],];
        // }
        // 可能效能更好，更適合應付大型專案????????
        //==================================================================
        let shuffledArray = [...filteredArray];

        // shuffledArray = datas.filter((item) => {
        //   console.log(item);
        //   return (
        //     item.Region == "臺中市" ||
        //     item.Region == "彰化縣" ||
        //     item.Region == "南投縣"
        //   );
        // });

        shuffledArray.sort(() => {
          return Math.random() - 0.5;
        });
        // =================================================================

        $(".attrCardContainer").empty();

        // ■■■■■插入卡片■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
        shuffledArray.slice(0, randomCard).forEach((data, index) => {
          // console.log(data.Id);
          let template = `
            <div class="attrCard " data-index="${index}" data-id="${data.Id}">
              <img
                src="${data.Picture1}"
                class="attrCardImgTop"
                alt="..."
              />
              <div class="attrCardBody" data-number="${data.Region}">
                <h5 class="attrCardTitle">${data.Name}</h5>
                <div class="attrCardContent">
                  <p class="attrCardText"><i class="bi bi-geo-alt"></i>${data.Town}</p>
                  <a class="moreBtn" type="button">顯示更多</a>
                </div>
              </div>
            </div>`;
          $(".attrCardContainer").append(template);
        });

        // ■■■■■顯示旅遊地址詳細資訊■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
        function showCover(index) {
          const selectattrCard = shuffledArray[index];

          // 空值合併運算子 (??)
          // 檢查[??]左操作數是否為 null 或 undefined，如果是，則使用[??]右操作數 ("資料尚未建構")。
          let travellinginfo = selectattrCard.Travellinginfo
            ? selectattrCard.Travellinginfo
            : "交通資料尚未建構";
          let picdescribe1 = selectattrCard.Picdescribe1
            ? selectattrCard.Picdescribe1
            : "尚無資訊";
          let name = selectattrCard.Name
            ? selectattrCard.Name
            : "姓名資料尚未建構";
          let opentime = selectattrCard.Opentime
            ? selectattrCard.Opentime
            : "資料尚未建構";
          let tel = selectattrCard.Tel
            ? selectattrCard.Tel
            : "電話資料尚未建構";
          let ticketinfo = selectattrCard.Ticketinfo
            ? selectattrCard.Ticketinfo
            : "資料尚未建構";
          let add = selectattrCard.Add
            ? selectattrCard.Add
            : "地址資料尚未建構";
          let description = selectattrCard.Description
            ? selectattrCard.Description
            : "資料尚未建構";
          let remarks = selectattrCard.Remarks
            ? selectattrCard.Remarks
            : "目前沒有資訊呦";

          let template = `
          <div class="attrBackground">11111
            <div class="attrInfo">
              <div class="infoTop row">
                <div class="btn btn-danger attrInfoBtn">Close</div>
                <div class="attrMainImg col-md-5">
                  <div class="attrImg">
                    <img
                      class="Picture1"
                      src="${selectattrCard.Picture1}"
                    />
                    <span class="Picdescribe1 d-none d-lg-block"
                      >${picdescribe1}</span
                    >
                  </div>
                </div>

                <div class="attrMainInfo col-md-5">
                  <div>
                    <span class="attrName">${name}</span>
                  </div>
                  <div class="row">
                    <div class="col-md-12">
                      <div class="attrOpenTime">
                        開放時間 : <span>${opentime}</span>
                      </div>
                      <div class="attrTel">
                        連絡電話 : <span>${tel}</span>
                      </div>
                    </div>
                    <div class="col">
                      <div class="attrTicketInfo">景點費用 : <span>${ticketinfo}</span></div>
                      <div class="attrAdd">
                        景點地址 : <span>${add}</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="attrDescription">
                ${description}
              </div>
              <div class="attrTravellinginfo">
                <span>交通方式</span>
                <p>
                  ${travellinginfo}
                </p>
              </div>
              <div class="attrToldescribe">
                ${picdescribe1}
              </div>
              <div class="attrRemarks" data-title="小知識">
                <span
                  >${remarks}</span
                >
              </div>
            </div>
          </div>
          `;
          $(".attrCardContainer").append(template);
          $(".attrInfo").addClass("active");
        }

        // ■■■■■點擊卡片使其打開■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
        $(".attrCardContainer").on("click", ".attrCard", (e) => {
          let that = e.currentTarget;
          const attrCardIndex = $(that).data("index");
          showCover(attrCardIndex);
        });
      });
      $(".left").on("click", function () {
        // 重载页面
        location.reload();
      });
    </script>
    <script>
      // jQuary版本
      $("#next").on("click", () => {
        // 要緊鄰著中間無空格
        let current = $(".image.active");
        let dot = $(".dot.active");
        current.removeClass("active");
        dot.removeClass("active animate__animated animate__rubberBand");
        let next = current.next(".image").length
          ? current.next(".image")
          : $(".image").first();
        let nextDot = dot.next(".dot").length
          ? dot.next(".dot")
          : $(".dot").first();
        next.addClass("active");
        nextDot.addClass("active animate__animated animate__rubberBand");
      });
      $("#prev").on("click", () => {
        // 要緊鄰著中間無空格
        let current = $(".image.active");
        let dot = $(".dot.active");
        current.removeClass("active");
        dot.removeClass("active animate__animated animate__rubberBand");
        let prev = current.prev(".image").length
          ? current.prev(".image")
          : $(".image").last();
        let prevDot = dot.prev(".dot").length
          ? dot.prev(".dot")
          : $(".dot").last();
        prev.addClass("active");
        prevDot.addClass("active animate__animated animate__rubberBand");
      });

      // ■■■下方條按鈕■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
      $(".dot").on("click", function () {
        let clickDot = $(this).index();
        let images = $(".image");
        let dots = $(".dot");
        images.removeClass("active");
        dots.removeClass("active animate__animated animate__rubberBand");
        let clickAddActiveImage = images.eq(clickDot);
        let clickAddActiveDot = dots.eq(clickDot);
        clickAddActiveImage.addClass("active");
        clickAddActiveDot.addClass(
          "active animate__animated animate__rubberBand"
        );
      });

      // ■■■圖片連結■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
      const websiteLinks = [
        "https://www.kkday.com/zh-my/blog/338/taiwan-must-go",
        "https://blog.settour.com.tw/special-plan/taiwan-japanese-attractions",
        "https://www.eztravel.com.tw/events/taiwanpromo/",
        "https://asiayo.com/event/taiwan_twfit.html",
        "https://explorethesun.tw/story_detail.php?id=54",
      ];

      $(".image").on("click", function () {
        let clickImgFromDot = $(".dot.active").index();
        window.open(websiteLinks[clickImgFromDot], "_blank");
      });

      // ■■■按鈕微動畫■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
      $(".ctrl_btn").each(function () {
        $(this).on("click", function (e) {
          let ctrlI = $(this).find(".ctrl_i");
          ctrlI.removeClass("animate__animated animate__rubberBand");
          // 強制重新繪製，以觸發動畫
          void ctrlI[0].offsetWidth;
          ctrlI.addClass("animate__animated animate__rubberBand");
        });

        $(this).on("mouseenter", function (e) {
          let ctrlI = $(this).find(".ctrl_i");
          ctrlI.addClass("animate__animated animate__rubberBand");
        });
        $(this).on("mouseleave", function (e) {
          let ctrlI = $(this).find(".ctrl_i");
          ctrlI.removeClass("animate__animated animate__rubberBand");
        });
      });

      // ■■■自動撥放■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■
      let timerId = setInterval(function () {
        $("#next").click();
      }, 3000);
      const slider = $(".ctrl");
      slider.on("mouseenter", function () {
        clearInterval(timerId);
      });
      slider.on("mouseleave", function () {
        if (timerId) clearInterval(timerId);
        timerId = setInterval(function () {
          $("#next").click();
        }, 3000);
      });
    </script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
